<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>AVRliberty: E:/!Work/AVR/avr-liberty/encoder.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>E:/!Work/AVR/avr-liberty/encoder.h File Reference</h1>
<p>Quadrature Encoder reader/driver.  
<a href="#_details">More...</a></p>
<code>#include &quot;global.h&quot;</code><br/>
<code>#include &quot;encoderconf.h&quot;</code><br/>

<p><a href="encoder_8h_source.html">Go to the source code of this file.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structstruct___encoder_state.html">struct_EncoderState</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Encoder state structure.  <a href="structstruct___encoder_state.html#_details">More...</a><br/></td></tr>
<tr><td colspan="2"><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="encoder_8h.html#aa02c46c3c011fea5dc710fd5d57cc4c9">IMSK</a>&nbsp;&nbsp;&nbsp;GIMSK</td></tr>
<tr><td colspan="2"><h2>Typedefs</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structstruct___encoder_state.html">struct_EncoderState</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="encoder_8h.html#a6f6ec5fd41d777896abbb574ee8989b3">EncoderStateType</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Encoder state structure.  <a href="#a6f6ec5fd41d777896abbb574ee8989b3"></a><br/></td></tr>
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="encoder_8h.html#aa8c681c8b873261098816919e87bc51f">encoderInit</a> (void)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><a class="el" href="encoder_8c.html#aa8c681c8b873261098816919e87bc51f" title="encoderInit() initializes hardware and encoder position readings">encoderInit()</a> initializes hardware and encoder position readings  <a href="#aa8c681c8b873261098816919e87bc51f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="encoder_8h.html#a1502d3e77959dcf9000f779ca03e9410">encoderOff</a> (void)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><a class="el" href="encoder_8c.html#a1502d3e77959dcf9000f779ca03e9410" title="encoderOff() disables hardware and stops encoder position updates">encoderOff()</a> disables hardware and stops encoder position updates  <a href="#a1502d3e77959dcf9000f779ca03e9410"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="avrlibtypes_8h.html#adafe97a8e4be18b0198f234819016582">s32</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="encoder_8h.html#ac6883a27ed583125a9b0dde1860e0b8d">encoderGetPosition</a> (<a class="el" href="avrlibtypes_8h.html#a4a020a9446b094e07e53376ac939a64d">u08</a> encoderNum)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><a class="el" href="encoder_8c.html#ac6883a27ed583125a9b0dde1860e0b8d" title="encoderGetPosition() reads the current position of the encoder">encoderGetPosition()</a> reads the current position of the encoder  <a href="#ac6883a27ed583125a9b0dde1860e0b8d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="encoder_8h.html#a1d9c9e24c6d8fa1dfa22a0bbf2823a28">encoderSetPosition</a> (<a class="el" href="avrlibtypes_8h.html#a4a020a9446b094e07e53376ac939a64d">u08</a> encoderNum, <a class="el" href="avrlibtypes_8h.html#adafe97a8e4be18b0198f234819016582">s32</a> position)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><a class="el" href="encoder_8c.html#a1d9c9e24c6d8fa1dfa22a0bbf2823a28" title="encoderSetPosition() sets the current position of the encoder">encoderSetPosition()</a> sets the current position of the encoder  <a href="#a1d9c9e24c6d8fa1dfa22a0bbf2823a28"></a><br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>Quadrature Encoder reader/driver. </p>

<p>Definition in file <a class="el" href="encoder_8h_source.html">encoder.h</a>.</p>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="aa02c46c3c011fea5dc710fd5d57cc4c9"></a><!-- doxytag: member="encoder.h::IMSK" ref="aa02c46c3c011fea5dc710fd5d57cc4c9" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define IMSK&nbsp;&nbsp;&nbsp;GIMSK</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl class="user"><dt><b>Operation:</b></dt><dd>Quadrature encoders have two digital outputs usually called PhaseA and PhaseB. When the encoder rotates, PhaseA and PhaseB produce square wave pulses where each pulse represents a fraction of a turn of the encoder shaft. Encoders are rated for a certain number of pulses (or counts) per complete revolution of the shaft. Common counts/revolution specs are 50, 100,128,200,250,256,500,etc. By counting the number of pulses output on one of the phases starting from time0, you can calculate the total rotational distance the encoder has traveled.</dd></dl>
<p>Often, however, we want current position not just total distance traveled. For this it is necessary to know not only how far the encoder has traveled, but also which direction it was going at each step of the way. To do this we need to use both outputs (or phases) of the quadrature encoder.</p>
<p>The pulses from PhaseA and PhaseB on quadrature encoders are always aligned 90 degrees out-of-phase (otherwise said: 1/4 wavelength apart). This special phase relationship lets us extract both the distance and direction the encoder has rotated from the outputs.</p>
<p>To do this, consider Phase A to be the distance counter. On each rising edge of PhaseA we will count 1 "tic" of distance, but we need to know the direction. Look at the quadrature waveform plot below. Notice that when we travel forward in time (left-&gt;right), PhaseB is always low (logic 0) at the rising edge of PhaseA. When we travel backwards in time (right-&gt;left), PhaseB is always high (logic 1) at the rising edge of PhaseA. Note that traveling forward or backwards in time is the same thing as rotating forwards or bardwards. Thus, if PhaseA is our counter, PhaseB indicates direction.</p>
<p>Here is an example waveform from a quadrature encoder: To keep track of the encoder position in software, we connect PhaseA to an external processor interrupt line, and PhaseB to any I/O pin. We set up the external interrupt to trigger whenever PhaseA produces a rising edge. When a rising edge is detected, our interrupt handler function is executed. Inside the handler function, we quickly check the PhaseB line to see if it is high or low. If it is high, we increment the encoder's position counter, otherwise we decrement it. The encoder position counter can be read at any time to find out the current position. </p>

<p>Definition at line <a class="el" href="encoder_8h_source.html#l00110">110</a> of file <a class="el" href="encoder_8h_source.html">encoder.h</a>.</p>

</div>
</div>
<hr/><h2>Typedef Documentation</h2>
<a class="anchor" id="a6f6ec5fd41d777896abbb574ee8989b3"></a><!-- doxytag: member="encoder.h::EncoderStateType" ref="a6f6ec5fd41d777896abbb574ee8989b3" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structstruct___encoder_state.html">struct_EncoderState</a>  <a class="el" href="structstruct___encoder_state.html">EncoderStateType</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Encoder state structure. </p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="ac6883a27ed583125a9b0dde1860e0b8d"></a><!-- doxytag: member="encoder.h::encoderGetPosition" ref="ac6883a27ed583125a9b0dde1860e0b8d" args="(u08 encoderNum)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="avrlibtypes_8h.html#adafe97a8e4be18b0198f234819016582">s32</a> encoderGetPosition </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="avrlibtypes_8h.html#a4a020a9446b094e07e53376ac939a64d">u08</a>&nbsp;</td>
          <td class="paramname"> <em>encoderNum</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><a class="el" href="encoder_8c.html#ac6883a27ed583125a9b0dde1860e0b8d" title="encoderGetPosition() reads the current position of the encoder">encoderGetPosition()</a> reads the current position of the encoder </p>

<p>Definition at line <a class="el" href="encoder_8c_source.html#l00134">134</a> of file <a class="el" href="encoder_8c_source.html">encoder.c</a>.</p>

</div>
</div>
<a class="anchor" id="aa8c681c8b873261098816919e87bc51f"></a><!-- doxytag: member="encoder.h::encoderInit" ref="aa8c681c8b873261098816919e87bc51f" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void encoderInit </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><a class="el" href="encoder_8c.html#aa8c681c8b873261098816919e87bc51f" title="encoderInit() initializes hardware and encoder position readings">encoderInit()</a> initializes hardware and encoder position readings </p>

<p>Definition at line <a class="el" href="encoder_8c_source.html#l00037">37</a> of file <a class="el" href="encoder_8c_source.html">encoder.c</a>.</p>

</div>
</div>
<a class="anchor" id="a1502d3e77959dcf9000f779ca03e9410"></a><!-- doxytag: member="encoder.h::encoderOff" ref="a1502d3e77959dcf9000f779ca03e9410" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void encoderOff </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><a class="el" href="encoder_8c.html#a1502d3e77959dcf9000f779ca03e9410" title="encoderOff() disables hardware and stops encoder position updates">encoderOff()</a> disables hardware and stops encoder position updates </p>

<p>Definition at line <a class="el" href="encoder_8c_source.html#l00112">112</a> of file <a class="el" href="encoder_8c_source.html">encoder.c</a>.</p>

</div>
</div>
<a class="anchor" id="a1d9c9e24c6d8fa1dfa22a0bbf2823a28"></a><!-- doxytag: member="encoder.h::encoderSetPosition" ref="a1d9c9e24c6d8fa1dfa22a0bbf2823a28" args="(u08 encoderNum, s32 position)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void encoderSetPosition </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="avrlibtypes_8h.html#a4a020a9446b094e07e53376ac939a64d">u08</a>&nbsp;</td>
          <td class="paramname"> <em>encoderNum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="avrlibtypes_8h.html#adafe97a8e4be18b0198f234819016582">s32</a>&nbsp;</td>
          <td class="paramname"> <em>position</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><a class="el" href="encoder_8c.html#a1d9c9e24c6d8fa1dfa22a0bbf2823a28" title="encoderSetPosition() sets the current position of the encoder">encoderSetPosition()</a> sets the current position of the encoder </p>

<p>Definition at line <a class="el" href="encoder_8c_source.html#l00144">144</a> of file <a class="el" href="encoder_8c_source.html">encoder.c</a>.</p>

</div>
</div>
</div>
<hr size="1"/><address style="text-align: right;"><small>Generated on Tue Sep 22 16:50:39 2009 for AVRliberty by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
