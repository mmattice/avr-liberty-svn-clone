<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>AVRliberty: STX/ETX Packet Protocol Library (stxetx.c)</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>STX/ETX Packet Protocol Library (stxetx.c)<br/>
<small>
[<a class="el" href="group__general.html">General Libraries</a>]</small>
</h1><table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__stxetx.html#gaacd744a917e61146ec8b7175b4761683">STX</a>&nbsp;&nbsp;&nbsp;0x02</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__stxetx.html#gaf02558e983dd26832a852bf186ed6726">ETX</a>&nbsp;&nbsp;&nbsp;0x03</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__stxetx.html#ga00b635455407fb147217b119297dfa3e">STXETX_HEADERLENGTH</a>&nbsp;&nbsp;&nbsp;4</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__stxetx.html#ga7c1a55b4c5e3bf137714446c3aa04712">STXETX_TRAILERLENGTH</a>&nbsp;&nbsp;&nbsp;2</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__stxetx.html#gac4e56a5dfc238c80663b75d76b0ddc3f">STXETX_STATUSOFFSET</a>&nbsp;&nbsp;&nbsp;1</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__stxetx.html#ga85d8cd4538060152b8cd0b6ca08f56bb">STXETX_TYPEOFFSET</a>&nbsp;&nbsp;&nbsp;2</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__stxetx.html#gaa5bd7fc13fb0edae208cac2088e20df2">STXETX_LENGTHOFFSET</a>&nbsp;&nbsp;&nbsp;3</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__stxetx.html#gaa1806ece448470d45d3cefeb7f7b2cb5">STXETX_DATAOFFSET</a>&nbsp;&nbsp;&nbsp;4</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__stxetx.html#gac86024eed808e66316fd2f26d3f2c17d">STXETX_CHECKSUMOFFSET</a>&nbsp;&nbsp;&nbsp;4</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__stxetx.html#ga33fbb3311f40ca8306a6672c21e00903">STXETX_NOETXSTXCHECKSUM</a>&nbsp;&nbsp;&nbsp;3</td></tr>
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__stxetx.html#gadad7542fda902a95de3ea1127be3aa7b">stxetxInit</a> (void(*dataout_func)(unsigned char data))</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initialize STX/ETX packet protocol library.  <a href="#gadad7542fda902a95de3ea1127be3aa7b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__stxetx.html#gaa8f2fe6c089bb62ace276a1f85b1c88d">stxetxSend</a> (unsigned char status, unsigned char type, unsigned char datalength, unsigned char *dataptr)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Send/Create STX/ETX packet.  <a href="#gaa8f2fe6c089bb62ace276a1f85b1c88d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">unsigned char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__stxetx.html#ga2ed0053b55e412fbd0c836f1b274f643">stxetxProcess</a> (<a class="el" href="structstruct__c_buffer.html">cBuffer</a> *rxBuffer)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Process a buffer containing STX/ETX packets.  <a href="#ga2ed0053b55e412fbd0c836f1b274f643"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">unsigned char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__stxetx.html#ga505985d1689f1096fb027ab33a88a28d">stxetxGetRxPacketStatus</a> (void)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns the received packet's status.  <a href="#ga505985d1689f1096fb027ab33a88a28d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">unsigned char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__stxetx.html#ga91eb69f45b0d6561482685189b870d60">stxetxGetRxPacketType</a> (void)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns the received packet's type.  <a href="#ga91eb69f45b0d6561482685189b870d60"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">unsigned char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__stxetx.html#ga3cb299b0ab345b51b915abbb680bd940">stxetxGetRxPacketDatalength</a> (void)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns the received packet's datalength.  <a href="#ga3cb299b0ab345b51b915abbb680bd940"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">unsigned char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__stxetx.html#gaff32a4b5b81191626e590be410aa90a1">stxetxGetRxPacketData</a> (void)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns pointer to the received packet's data.  <a href="#gaff32a4b5b81191626e590be410aa90a1"></a><br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<div class="fragment"><pre class="fragment"><span class="preprocessor"> #include &quot;<a class="code" href="stxetx_8h.html" title="STX/ETX Packet Protocol Implementation Library.">stxetx.h</a>&quot;</span> 
</pre></div> <dl class="user"><dt><b>Overview</b></dt><dd>This library provides functions needed to transmit and receive STX/ETX packets over any interface which can send and receive bytes.  STX/ETX is a simple packet protocol for serial data streams and offers packetization, type tagging, and checksum protection for user data.  Common uses of STX/ETX might include radio communications were it can improve data reliability over lossy channels.  STX/ETX may also be used effectively anywhere multiple access to the communication medium is required.  The packets can be made to contain destination addresses or routing information as well as data.</dd></dl>
<dl class="user"><dt><b>STX/ETX Details</b></dt><dd>STX/ETX is a simple packet protocol that can be wrapped around user data for one or more of the following reasons: 1. packetization is needed<ul>
<li>Using packets can be helpful if your data naturally forms little "bunches" or if different types of data must be sent over the same channel (a serial cable, for example). If your data forms "bunches", you can send user data inside STX/ETX packets with a predetermined structure, like an array of A/D conversion results. If you need a way to tell the receiver what kind of data you're sending, you can use the TYPE field in the STX/ETX packet. 2. error checking is needed</li>
<li>STX/ETX packets will add a checksum to your data. This allows the receiver to verify that data was received correctly and is error-free. Packets which are corrupted in transmission and fail the the checksum test are automatically discarded. Error checking is especially useful when the data transmission channel is unreliable or noisy (examples: radio, infrared, long cables, etc)</li>
</ul>
</dd></dl>
<p>STX/ETX packets have the following structure:</p>
<p>[STX][status][type][length][user data...][checksum][ETX]</p>
<p>All fields are 1 byte except for user data which may be 0-255 bytes. Uppercase fields are constant (STX=0x02, ETX=0x03), lowercase fields vary. The length field is the number of bytes in the user data area. The checksum is the 8-bit sum of all bytes between but not including STX/ETX. </p>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="gaf02558e983dd26832a852bf186ed6726"></a><!-- doxytag: member="stxetx.h::ETX" ref="gaf02558e983dd26832a852bf186ed6726" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ETX&nbsp;&nbsp;&nbsp;0x03</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="stxetx_8h_source.html#l00074">74</a> of file <a class="el" href="stxetx_8h_source.html">stxetx.h</a>.</p>

</div>
</div>
<a class="anchor" id="gaacd744a917e61146ec8b7175b4761683"></a><!-- doxytag: member="stxetx.h::STX" ref="gaacd744a917e61146ec8b7175b4761683" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define STX&nbsp;&nbsp;&nbsp;0x02</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="stxetx_8h_source.html#l00073">73</a> of file <a class="el" href="stxetx_8h_source.html">stxetx.h</a>.</p>

</div>
</div>
<a class="anchor" id="gac86024eed808e66316fd2f26d3f2c17d"></a><!-- doxytag: member="stxetx.h::STXETX_CHECKSUMOFFSET" ref="gac86024eed808e66316fd2f26d3f2c17d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define STXETX_CHECKSUMOFFSET&nbsp;&nbsp;&nbsp;4</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="stxetx_8h_source.html#l00083">83</a> of file <a class="el" href="stxetx_8h_source.html">stxetx.h</a>.</p>

</div>
</div>
<a class="anchor" id="gaa1806ece448470d45d3cefeb7f7b2cb5"></a><!-- doxytag: member="stxetx.h::STXETX_DATAOFFSET" ref="gaa1806ece448470d45d3cefeb7f7b2cb5" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define STXETX_DATAOFFSET&nbsp;&nbsp;&nbsp;4</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="stxetx_8h_source.html#l00082">82</a> of file <a class="el" href="stxetx_8h_source.html">stxetx.h</a>.</p>

</div>
</div>
<a class="anchor" id="ga00b635455407fb147217b119297dfa3e"></a><!-- doxytag: member="stxetx.h::STXETX_HEADERLENGTH" ref="ga00b635455407fb147217b119297dfa3e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define STXETX_HEADERLENGTH&nbsp;&nbsp;&nbsp;4</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="stxetx_8h_source.html#l00076">76</a> of file <a class="el" href="stxetx_8h_source.html">stxetx.h</a>.</p>

</div>
</div>
<a class="anchor" id="gaa5bd7fc13fb0edae208cac2088e20df2"></a><!-- doxytag: member="stxetx.h::STXETX_LENGTHOFFSET" ref="gaa5bd7fc13fb0edae208cac2088e20df2" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define STXETX_LENGTHOFFSET&nbsp;&nbsp;&nbsp;3</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="stxetx_8h_source.html#l00081">81</a> of file <a class="el" href="stxetx_8h_source.html">stxetx.h</a>.</p>

</div>
</div>
<a class="anchor" id="ga33fbb3311f40ca8306a6672c21e00903"></a><!-- doxytag: member="stxetx.h::STXETX_NOETXSTXCHECKSUM" ref="ga33fbb3311f40ca8306a6672c21e00903" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define STXETX_NOETXSTXCHECKSUM&nbsp;&nbsp;&nbsp;3</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="stxetx_8h_source.html#l00084">84</a> of file <a class="el" href="stxetx_8h_source.html">stxetx.h</a>.</p>

</div>
</div>
<a class="anchor" id="gac4e56a5dfc238c80663b75d76b0ddc3f"></a><!-- doxytag: member="stxetx.h::STXETX_STATUSOFFSET" ref="gac4e56a5dfc238c80663b75d76b0ddc3f" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define STXETX_STATUSOFFSET&nbsp;&nbsp;&nbsp;1</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="stxetx_8h_source.html#l00079">79</a> of file <a class="el" href="stxetx_8h_source.html">stxetx.h</a>.</p>

</div>
</div>
<a class="anchor" id="ga7c1a55b4c5e3bf137714446c3aa04712"></a><!-- doxytag: member="stxetx.h::STXETX_TRAILERLENGTH" ref="ga7c1a55b4c5e3bf137714446c3aa04712" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define STXETX_TRAILERLENGTH&nbsp;&nbsp;&nbsp;2</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="stxetx_8h_source.html#l00077">77</a> of file <a class="el" href="stxetx_8h_source.html">stxetx.h</a>.</p>

</div>
</div>
<a class="anchor" id="ga85d8cd4538060152b8cd0b6ca08f56bb"></a><!-- doxytag: member="stxetx.h::STXETX_TYPEOFFSET" ref="ga85d8cd4538060152b8cd0b6ca08f56bb" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define STXETX_TYPEOFFSET&nbsp;&nbsp;&nbsp;2</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="stxetx_8h_source.html#l00080">80</a> of file <a class="el" href="stxetx_8h_source.html">stxetx.h</a>.</p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="gaff32a4b5b81191626e590be410aa90a1"></a><!-- doxytag: member="stxetx.h::stxetxGetRxPacketData" ref="gaff32a4b5b81191626e590be410aa90a1" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned char* stxetxGetRxPacketData </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Returns pointer to the received packet's data. </p>

<p>Definition at line <a class="el" href="stxetx_8c_source.html#l00213">213</a> of file <a class="el" href="stxetx_8c_source.html">stxetx.c</a>.</p>

</div>
</div>
<a class="anchor" id="ga3cb299b0ab345b51b915abbb680bd940"></a><!-- doxytag: member="stxetx.h::stxetxGetRxPacketDatalength" ref="ga3cb299b0ab345b51b915abbb680bd940" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned char stxetxGetRxPacketDatalength </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Returns the received packet's datalength. </p>

<p>Definition at line <a class="el" href="stxetx_8c_source.html#l00206">206</a> of file <a class="el" href="stxetx_8c_source.html">stxetx.c</a>.</p>

</div>
</div>
<a class="anchor" id="ga505985d1689f1096fb027ab33a88a28d"></a><!-- doxytag: member="stxetx.h::stxetxGetRxPacketStatus" ref="ga505985d1689f1096fb027ab33a88a28d" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned char stxetxGetRxPacketStatus </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Returns the received packet's status. </p>

<p>Definition at line <a class="el" href="stxetx_8c_source.html#l00192">192</a> of file <a class="el" href="stxetx_8c_source.html">stxetx.c</a>.</p>

</div>
</div>
<a class="anchor" id="ga91eb69f45b0d6561482685189b870d60"></a><!-- doxytag: member="stxetx.h::stxetxGetRxPacketType" ref="ga91eb69f45b0d6561482685189b870d60" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned char stxetxGetRxPacketType </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Returns the received packet's type. </p>

<p>Definition at line <a class="el" href="stxetx_8c_source.html#l00199">199</a> of file <a class="el" href="stxetx_8c_source.html">stxetx.c</a>.</p>

</div>
</div>
<a class="anchor" id="gadad7542fda902a95de3ea1127be3aa7b"></a><!-- doxytag: member="stxetx.h::stxetxInit" ref="gadad7542fda902a95de3ea1127be3aa7b" args="(void(*dataout_func)(unsigned char data))" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void stxetxInit </td>
          <td>(</td>
          <td class="paramtype">void(*)(unsigned char data)&nbsp;</td>
          <td class="paramname"> <em>dataout_func</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Initialize STX/ETX packet protocol library. </p>

<p>Definition at line <a class="el" href="stxetx_8c_source.html#l00064">64</a> of file <a class="el" href="stxetx_8c_source.html">stxetx.c</a>.</p>

</div>
</div>
<a class="anchor" id="ga2ed0053b55e412fbd0c836f1b274f643"></a><!-- doxytag: member="stxetx.h::stxetxProcess" ref="ga2ed0053b55e412fbd0c836f1b274f643" args="(cBuffer *rxBuffer)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned char stxetxProcess </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structstruct__c_buffer.html">cBuffer</a> *&nbsp;</td>
          <td class="paramname"> <em>rxBuffer</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Process a buffer containing STX/ETX packets. </p>

<p>Definition at line <a class="el" href="stxetx_8c_source.html#l00095">95</a> of file <a class="el" href="stxetx_8c_source.html">stxetx.c</a>.</p>

</div>
</div>
<a class="anchor" id="gaa8f2fe6c089bb62ace276a1f85b1c88d"></a><!-- doxytag: member="stxetx.h::stxetxSend" ref="gaa8f2fe6c089bb62ace276a1f85b1c88d" args="(unsigned char status, unsigned char type, unsigned char datalength, unsigned char *dataptr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void stxetxSend </td>
          <td>(</td>
          <td class="paramtype">unsigned char&nbsp;</td>
          <td class="paramname"> <em>status</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&nbsp;</td>
          <td class="paramname"> <em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&nbsp;</td>
          <td class="paramname"> <em>datalength</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&nbsp;</td>
          <td class="paramname"> <em>dataptr</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Send/Create STX/ETX packet. </p>

<p>Definition at line <a class="el" href="stxetx_8c_source.html#l00070">70</a> of file <a class="el" href="stxetx_8c_source.html">stxetx.c</a>.</p>

</div>
</div>
</div>
<hr size="1"/><address style="text-align: right;"><small>Generated on Tue Sep 22 16:50:42 2009 for AVRliberty by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
